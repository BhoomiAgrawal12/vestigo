                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 4.0.0 #11528 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module aes128
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _main
                             12 	.globl _aes128_encrypt
                             13 	.globl _puts
                             14 	.globl _printf
                             15 ;--------------------------------------------------------
                             16 ; special function registers
                             17 ;--------------------------------------------------------
                             18 ;--------------------------------------------------------
                             19 ; ram data
                             20 ;--------------------------------------------------------
                             21 	.area _DATA
                             22 ;--------------------------------------------------------
                             23 ; ram data
                             24 ;--------------------------------------------------------
                             25 	.area _INITIALIZED
                             26 ;--------------------------------------------------------
                             27 ; absolute external ram data
                             28 ;--------------------------------------------------------
                             29 	.area _DABS (ABS)
                             30 ;--------------------------------------------------------
                             31 ; global & static initialisations
                             32 ;--------------------------------------------------------
                             33 	.area _HOME
                             34 	.area _GSINIT
                             35 	.area _GSFINAL
                             36 	.area _GSINIT
                             37 ;--------------------------------------------------------
                             38 ; Home
                             39 ;--------------------------------------------------------
                             40 	.area _HOME
                             41 	.area _HOME
                             42 ;--------------------------------------------------------
                             43 ; code
                             44 ;--------------------------------------------------------
                             45 	.area _CODE
                             46 ;source_code/aes128.c:38: static uint8_t xtime(uint8_t x) {
                             47 ;	---------------------------------
                             48 ; Function xtime
                             49 ; ---------------------------------
   0000                      50 _xtime:
   0000 CDr00r00      [17]   51 	call	___sdcc_enter_ix
                             52 ;source_code/aes128.c:39: return ((x << 1) ^ (((x >> 7) & 1) * 0x1b));
   0003 DD 7E 04      [19]   53 	ld	a, 4 (ix)
   0006 87            [ 4]   54 	add	a, a
   0007 4F            [ 4]   55 	ld	c, a
   0008 DD 7E 04      [19]   56 	ld	a, 4 (ix)
   000B CB 07         [ 8]   57 	rlc	a
   000D E6 01         [ 7]   58 	and	a, #0x01
   000F 5F            [ 4]   59 	ld	e, a
   0010 16 00         [ 7]   60 	ld	d, #0x00
   0012 6B            [ 4]   61 	ld	l, e
   0013 62            [ 4]   62 	ld	h, d
   0014 29            [11]   63 	add	hl, hl
   0015 19            [11]   64 	add	hl, de
   0016 29            [11]   65 	add	hl, hl
   0017 29            [11]   66 	add	hl, hl
   0018 19            [11]   67 	add	hl, de
   0019 29            [11]   68 	add	hl, hl
   001A 19            [11]   69 	add	hl, de
   001B 79            [ 4]   70 	ld	a, c
   001C 17            [ 4]   71 	rla
   001D 9F            [ 4]   72 	sbc	a, a
   001E F5            [11]   73 	push	af
   001F 79            [ 4]   74 	ld	a, c
   0020 AD            [ 4]   75 	xor	a, l
   0021 6F            [ 4]   76 	ld	l, a
   0022 F1            [10]   77 	pop	af
   0023 AC            [ 4]   78 	xor	a, h
                             79 ;source_code/aes128.c:40: }
   0024 DD E1         [14]   80 	pop	ix
   0026 C9            [10]   81 	ret
   0027                      82 _sbox:
   0027 63                   83 	.db #0x63	; 99	'c'
   0028 7C                   84 	.db #0x7c	; 124
   0029 77                   85 	.db #0x77	; 119	'w'
   002A 7B                   86 	.db #0x7b	; 123
   002B F2                   87 	.db #0xf2	; 242
   002C 6B                   88 	.db #0x6b	; 107	'k'
   002D 6F                   89 	.db #0x6f	; 111	'o'
   002E C5                   90 	.db #0xc5	; 197
   002F 30                   91 	.db #0x30	; 48	'0'
   0030 01                   92 	.db #0x01	; 1
   0031 67                   93 	.db #0x67	; 103	'g'
   0032 2B                   94 	.db #0x2b	; 43
   0033 FE                   95 	.db #0xfe	; 254
   0034 D7                   96 	.db #0xd7	; 215
   0035 AB                   97 	.db #0xab	; 171
   0036 76                   98 	.db #0x76	; 118	'v'
   0037 CA                   99 	.db #0xca	; 202
   0038 82                  100 	.db #0x82	; 130
   0039 C9                  101 	.db #0xc9	; 201
   003A 7D                  102 	.db #0x7d	; 125
   003B FA                  103 	.db #0xfa	; 250
   003C 59                  104 	.db #0x59	; 89	'Y'
   003D 47                  105 	.db #0x47	; 71	'G'
   003E F0                  106 	.db #0xf0	; 240
   003F AD                  107 	.db #0xad	; 173
   0040 D4                  108 	.db #0xd4	; 212
   0041 A2                  109 	.db #0xa2	; 162
   0042 AF                  110 	.db #0xaf	; 175
   0043 9C                  111 	.db #0x9c	; 156
   0044 A4                  112 	.db #0xa4	; 164
   0045 72                  113 	.db #0x72	; 114	'r'
   0046 C0                  114 	.db #0xc0	; 192
   0047 B7                  115 	.db #0xb7	; 183
   0048 FD                  116 	.db #0xfd	; 253
   0049 93                  117 	.db #0x93	; 147
   004A 26                  118 	.db #0x26	; 38
   004B 36                  119 	.db #0x36	; 54	'6'
   004C 3F                  120 	.db #0x3f	; 63
   004D F7                  121 	.db #0xf7	; 247
   004E CC                  122 	.db #0xcc	; 204
   004F 34                  123 	.db #0x34	; 52	'4'
   0050 A5                  124 	.db #0xa5	; 165
   0051 E5                  125 	.db #0xe5	; 229
   0052 F1                  126 	.db #0xf1	; 241
   0053 71                  127 	.db #0x71	; 113	'q'
   0054 D8                  128 	.db #0xd8	; 216
   0055 31                  129 	.db #0x31	; 49	'1'
   0056 15                  130 	.db #0x15	; 21
   0057 04                  131 	.db #0x04	; 4
   0058 C7                  132 	.db #0xc7	; 199
   0059 23                  133 	.db #0x23	; 35
   005A C3                  134 	.db #0xc3	; 195
   005B 18                  135 	.db #0x18	; 24
   005C 96                  136 	.db #0x96	; 150
   005D 05                  137 	.db #0x05	; 5
   005E 9A                  138 	.db #0x9a	; 154
   005F 07                  139 	.db #0x07	; 7
   0060 12                  140 	.db #0x12	; 18
   0061 80                  141 	.db #0x80	; 128
   0062 E2                  142 	.db #0xe2	; 226
   0063 EB                  143 	.db #0xeb	; 235
   0064 27                  144 	.db #0x27	; 39
   0065 B2                  145 	.db #0xb2	; 178
   0066 75                  146 	.db #0x75	; 117	'u'
   0067 09                  147 	.db #0x09	; 9
   0068 83                  148 	.db #0x83	; 131
   0069 2C                  149 	.db #0x2c	; 44
   006A 1A                  150 	.db #0x1a	; 26
   006B 1B                  151 	.db #0x1b	; 27
   006C 6E                  152 	.db #0x6e	; 110	'n'
   006D 5A                  153 	.db #0x5a	; 90	'Z'
   006E A0                  154 	.db #0xa0	; 160
   006F 52                  155 	.db #0x52	; 82	'R'
   0070 3B                  156 	.db #0x3b	; 59
   0071 D6                  157 	.db #0xd6	; 214
   0072 B3                  158 	.db #0xb3	; 179
   0073 29                  159 	.db #0x29	; 41
   0074 E3                  160 	.db #0xe3	; 227
   0075 2F                  161 	.db #0x2f	; 47
   0076 84                  162 	.db #0x84	; 132
   0077 53                  163 	.db #0x53	; 83	'S'
   0078 D1                  164 	.db #0xd1	; 209
   0079 00                  165 	.db #0x00	; 0
   007A ED                  166 	.db #0xed	; 237
   007B 20                  167 	.db #0x20	; 32
   007C FC                  168 	.db #0xfc	; 252
   007D B1                  169 	.db #0xb1	; 177
   007E 5B                  170 	.db #0x5b	; 91
   007F 6A                  171 	.db #0x6a	; 106	'j'
   0080 CB                  172 	.db #0xcb	; 203
   0081 BE                  173 	.db #0xbe	; 190
   0082 39                  174 	.db #0x39	; 57	'9'
   0083 4A                  175 	.db #0x4a	; 74	'J'
   0084 4C                  176 	.db #0x4c	; 76	'L'
   0085 58                  177 	.db #0x58	; 88	'X'
   0086 CF                  178 	.db #0xcf	; 207
   0087 D0                  179 	.db #0xd0	; 208
   0088 EF                  180 	.db #0xef	; 239
   0089 AA                  181 	.db #0xaa	; 170
   008A FB                  182 	.db #0xfb	; 251
   008B 43                  183 	.db #0x43	; 67	'C'
   008C 4D                  184 	.db #0x4d	; 77	'M'
   008D 33                  185 	.db #0x33	; 51	'3'
   008E 85                  186 	.db #0x85	; 133
   008F 45                  187 	.db #0x45	; 69	'E'
   0090 F9                  188 	.db #0xf9	; 249
   0091 02                  189 	.db #0x02	; 2
   0092 7F                  190 	.db #0x7f	; 127
   0093 50                  191 	.db #0x50	; 80	'P'
   0094 3C                  192 	.db #0x3c	; 60
   0095 9F                  193 	.db #0x9f	; 159
   0096 A8                  194 	.db #0xa8	; 168
   0097 51                  195 	.db #0x51	; 81	'Q'
   0098 A3                  196 	.db #0xa3	; 163
   0099 40                  197 	.db #0x40	; 64
   009A 8F                  198 	.db #0x8f	; 143
   009B 92                  199 	.db #0x92	; 146
   009C 9D                  200 	.db #0x9d	; 157
   009D 38                  201 	.db #0x38	; 56	'8'
   009E F5                  202 	.db #0xf5	; 245
   009F BC                  203 	.db #0xbc	; 188
   00A0 B6                  204 	.db #0xb6	; 182
   00A1 DA                  205 	.db #0xda	; 218
   00A2 21                  206 	.db #0x21	; 33
   00A3 10                  207 	.db #0x10	; 16
   00A4 FF                  208 	.db #0xff	; 255
   00A5 F3                  209 	.db #0xf3	; 243
   00A6 D2                  210 	.db #0xd2	; 210
   00A7 CD                  211 	.db #0xcd	; 205
   00A8 0C                  212 	.db #0x0c	; 12
   00A9 13                  213 	.db #0x13	; 19
   00AA EC                  214 	.db #0xec	; 236
   00AB 5F                  215 	.db #0x5f	; 95
   00AC 97                  216 	.db #0x97	; 151
   00AD 44                  217 	.db #0x44	; 68	'D'
   00AE 17                  218 	.db #0x17	; 23
   00AF C4                  219 	.db #0xc4	; 196
   00B0 A7                  220 	.db #0xa7	; 167
   00B1 7E                  221 	.db #0x7e	; 126
   00B2 3D                  222 	.db #0x3d	; 61
   00B3 64                  223 	.db #0x64	; 100	'd'
   00B4 5D                  224 	.db #0x5d	; 93
   00B5 19                  225 	.db #0x19	; 25
   00B6 73                  226 	.db #0x73	; 115	's'
   00B7 60                  227 	.db #0x60	; 96
   00B8 81                  228 	.db #0x81	; 129
   00B9 4F                  229 	.db #0x4f	; 79	'O'
   00BA DC                  230 	.db #0xdc	; 220
   00BB 22                  231 	.db #0x22	; 34
   00BC 2A                  232 	.db #0x2a	; 42
   00BD 90                  233 	.db #0x90	; 144
   00BE 88                  234 	.db #0x88	; 136
   00BF 46                  235 	.db #0x46	; 70	'F'
   00C0 EE                  236 	.db #0xee	; 238
   00C1 B8                  237 	.db #0xb8	; 184
   00C2 14                  238 	.db #0x14	; 20
   00C3 DE                  239 	.db #0xde	; 222
   00C4 5E                  240 	.db #0x5e	; 94
   00C5 0B                  241 	.db #0x0b	; 11
   00C6 DB                  242 	.db #0xdb	; 219
   00C7 E0                  243 	.db #0xe0	; 224
   00C8 32                  244 	.db #0x32	; 50	'2'
   00C9 3A                  245 	.db #0x3a	; 58
   00CA 0A                  246 	.db #0x0a	; 10
   00CB 49                  247 	.db #0x49	; 73	'I'
   00CC 06                  248 	.db #0x06	; 6
   00CD 24                  249 	.db #0x24	; 36
   00CE 5C                  250 	.db #0x5c	; 92
   00CF C2                  251 	.db #0xc2	; 194
   00D0 D3                  252 	.db #0xd3	; 211
   00D1 AC                  253 	.db #0xac	; 172
   00D2 62                  254 	.db #0x62	; 98	'b'
   00D3 91                  255 	.db #0x91	; 145
   00D4 95                  256 	.db #0x95	; 149
   00D5 E4                  257 	.db #0xe4	; 228
   00D6 79                  258 	.db #0x79	; 121	'y'
   00D7 E7                  259 	.db #0xe7	; 231
   00D8 C8                  260 	.db #0xc8	; 200
   00D9 37                  261 	.db #0x37	; 55	'7'
   00DA 6D                  262 	.db #0x6d	; 109	'm'
   00DB 8D                  263 	.db #0x8d	; 141
   00DC D5                  264 	.db #0xd5	; 213
   00DD 4E                  265 	.db #0x4e	; 78	'N'
   00DE A9                  266 	.db #0xa9	; 169
   00DF 6C                  267 	.db #0x6c	; 108	'l'
   00E0 56                  268 	.db #0x56	; 86	'V'
   00E1 F4                  269 	.db #0xf4	; 244
   00E2 EA                  270 	.db #0xea	; 234
   00E3 65                  271 	.db #0x65	; 101	'e'
   00E4 7A                  272 	.db #0x7a	; 122	'z'
   00E5 AE                  273 	.db #0xae	; 174
   00E6 08                  274 	.db #0x08	; 8
   00E7 BA                  275 	.db #0xba	; 186
   00E8 78                  276 	.db #0x78	; 120	'x'
   00E9 25                  277 	.db #0x25	; 37
   00EA 2E                  278 	.db #0x2e	; 46
   00EB 1C                  279 	.db #0x1c	; 28
   00EC A6                  280 	.db #0xa6	; 166
   00ED B4                  281 	.db #0xb4	; 180
   00EE C6                  282 	.db #0xc6	; 198
   00EF E8                  283 	.db #0xe8	; 232
   00F0 DD                  284 	.db #0xdd	; 221
   00F1 74                  285 	.db #0x74	; 116	't'
   00F2 1F                  286 	.db #0x1f	; 31
   00F3 4B                  287 	.db #0x4b	; 75	'K'
   00F4 BD                  288 	.db #0xbd	; 189
   00F5 8B                  289 	.db #0x8b	; 139
   00F6 8A                  290 	.db #0x8a	; 138
   00F7 70                  291 	.db #0x70	; 112	'p'
   00F8 3E                  292 	.db #0x3e	; 62
   00F9 B5                  293 	.db #0xb5	; 181
   00FA 66                  294 	.db #0x66	; 102	'f'
   00FB 48                  295 	.db #0x48	; 72	'H'
   00FC 03                  296 	.db #0x03	; 3
   00FD F6                  297 	.db #0xf6	; 246
   00FE 0E                  298 	.db #0x0e	; 14
   00FF 61                  299 	.db #0x61	; 97	'a'
   0100 35                  300 	.db #0x35	; 53	'5'
   0101 57                  301 	.db #0x57	; 87	'W'
   0102 B9                  302 	.db #0xb9	; 185
   0103 86                  303 	.db #0x86	; 134
   0104 C1                  304 	.db #0xc1	; 193
   0105 1D                  305 	.db #0x1d	; 29
   0106 9E                  306 	.db #0x9e	; 158
   0107 E1                  307 	.db #0xe1	; 225
   0108 F8                  308 	.db #0xf8	; 248
   0109 98                  309 	.db #0x98	; 152
   010A 11                  310 	.db #0x11	; 17
   010B 69                  311 	.db #0x69	; 105	'i'
   010C D9                  312 	.db #0xd9	; 217
   010D 8E                  313 	.db #0x8e	; 142
   010E 94                  314 	.db #0x94	; 148
   010F 9B                  315 	.db #0x9b	; 155
   0110 1E                  316 	.db #0x1e	; 30
   0111 87                  317 	.db #0x87	; 135
   0112 E9                  318 	.db #0xe9	; 233
   0113 CE                  319 	.db #0xce	; 206
   0114 55                  320 	.db #0x55	; 85	'U'
   0115 28                  321 	.db #0x28	; 40
   0116 DF                  322 	.db #0xdf	; 223
   0117 8C                  323 	.db #0x8c	; 140
   0118 A1                  324 	.db #0xa1	; 161
   0119 89                  325 	.db #0x89	; 137
   011A 0D                  326 	.db #0x0d	; 13
   011B BF                  327 	.db #0xbf	; 191
   011C E6                  328 	.db #0xe6	; 230
   011D 42                  329 	.db #0x42	; 66	'B'
   011E 68                  330 	.db #0x68	; 104	'h'
   011F 41                  331 	.db #0x41	; 65	'A'
   0120 99                  332 	.db #0x99	; 153
   0121 2D                  333 	.db #0x2d	; 45
   0122 0F                  334 	.db #0x0f	; 15
   0123 B0                  335 	.db #0xb0	; 176
   0124 54                  336 	.db #0x54	; 84	'T'
   0125 BB                  337 	.db #0xbb	; 187
   0126 16                  338 	.db #0x16	; 22
   0127                     339 _rcon:
   0127 00                  340 	.db #0x00	; 0
   0128 01                  341 	.db #0x01	; 1
   0129 02                  342 	.db #0x02	; 2
   012A 04                  343 	.db #0x04	; 4
   012B 08                  344 	.db #0x08	; 8
   012C 10                  345 	.db #0x10	; 16
   012D 20                  346 	.db #0x20	; 32
   012E 40                  347 	.db #0x40	; 64
   012F 80                  348 	.db #0x80	; 128
   0130 1B                  349 	.db #0x1b	; 27
   0131 36                  350 	.db #0x36	; 54	'6'
                            351 ;source_code/aes128.c:42: static void sub_bytes(uint8_t *state) {
                            352 ;	---------------------------------
                            353 ; Function sub_bytes
                            354 ; ---------------------------------
   0132                     355 _sub_bytes:
   0132 CDr00r00      [17]  356 	call	___sdcc_enter_ix
                            357 ;source_code/aes128.c:43: for (int i = 0; i < 16; i++) {
   0135 01 00 00      [10]  358 	ld	bc, #0x0000
   0138                     359 00103$:
   0138 79            [ 4]  360 	ld	a, c
   0139 D6 10         [ 7]  361 	sub	a, #0x10
   013B 78            [ 4]  362 	ld	a, b
   013C 17            [ 4]  363 	rla
   013D 3F            [ 4]  364 	ccf
   013E 1F            [ 4]  365 	rra
   013F DE 80         [ 7]  366 	sbc	a, #0x80
   0141 30 18         [12]  367 	jr	NC,00105$
                            368 ;source_code/aes128.c:44: state[i] = sbox[state[i]];
   0143 DD 7E 04      [19]  369 	ld	a, 4 (ix)
   0146 81            [ 4]  370 	add	a, c
   0147 5F            [ 4]  371 	ld	e, a
   0148 DD 7E 05      [19]  372 	ld	a, 5 (ix)
   014B 88            [ 4]  373 	adc	a, b
   014C 57            [ 4]  374 	ld	d, a
   014D 1A            [ 7]  375 	ld	a, (de)
   014E C6r27         [ 7]  376 	add	a, #<(_sbox)
   0150 6F            [ 4]  377 	ld	l, a
   0151 3E 00         [ 7]  378 	ld	a, #0x00
   0153 CEs00         [ 7]  379 	adc	a, #>(_sbox)
   0155 67            [ 4]  380 	ld	h, a
   0156 7E            [ 7]  381 	ld	a, (hl)
   0157 12            [ 7]  382 	ld	(de), a
                            383 ;source_code/aes128.c:43: for (int i = 0; i < 16; i++) {
   0158 03            [ 6]  384 	inc	bc
   0159 18 DD         [12]  385 	jr	00103$
   015B                     386 00105$:
                            387 ;source_code/aes128.c:46: }
   015B DD E1         [14]  388 	pop	ix
   015D C9            [10]  389 	ret
                            390 ;source_code/aes128.c:48: static void shift_rows(uint8_t *state) {
                            391 ;	---------------------------------
                            392 ; Function shift_rows
                            393 ; ---------------------------------
   015E                     394 _shift_rows:
   015E CDr00r00      [17]  395 	call	___sdcc_enter_ix
   0161 3B            [ 6]  396 	dec	sp
                            397 ;source_code/aes128.c:51: temp = state[1];
   0162 DD 5E 04      [19]  398 	ld	e, 4 (ix)
   0165 DD 56 05      [19]  399 	ld	d, 5 (ix)
   0168 13            [ 6]  400 	inc	de
   0169 1A            [ 7]  401 	ld	a, (de)
   016A DD 77 FF      [19]  402 	ld	-1 (ix), a
                            403 ;source_code/aes128.c:52: state[1] = state[5];
   016D DD 7E 04      [19]  404 	ld	a, 4 (ix)
   0170 C6 05         [ 7]  405 	add	a, #0x05
   0172 4F            [ 4]  406 	ld	c, a
   0173 DD 7E 05      [19]  407 	ld	a, 5 (ix)
   0176 CE 00         [ 7]  408 	adc	a, #0x00
   0178 47            [ 4]  409 	ld	b, a
   0179 0A            [ 7]  410 	ld	a, (bc)
   017A 12            [ 7]  411 	ld	(de), a
                            412 ;source_code/aes128.c:53: state[5] = state[9];
   017B DD 7E 04      [19]  413 	ld	a, 4 (ix)
   017E C6 09         [ 7]  414 	add	a, #0x09
   0180 5F            [ 4]  415 	ld	e, a
   0181 DD 7E 05      [19]  416 	ld	a, 5 (ix)
   0184 CE 00         [ 7]  417 	adc	a, #0x00
   0186 57            [ 4]  418 	ld	d, a
   0187 1A            [ 7]  419 	ld	a, (de)
   0188 02            [ 7]  420 	ld	(bc), a
                            421 ;source_code/aes128.c:54: state[9] = state[13];
   0189 DD 7E 04      [19]  422 	ld	a, 4 (ix)
   018C C6 0D         [ 7]  423 	add	a, #0x0d
   018E 4F            [ 4]  424 	ld	c, a
   018F DD 7E 05      [19]  425 	ld	a, 5 (ix)
   0192 CE 00         [ 7]  426 	adc	a, #0x00
   0194 47            [ 4]  427 	ld	b, a
   0195 0A            [ 7]  428 	ld	a, (bc)
   0196 12            [ 7]  429 	ld	(de), a
                            430 ;source_code/aes128.c:55: state[13] = temp;
   0197 DD 7E FF      [19]  431 	ld	a, -1 (ix)
   019A 02            [ 7]  432 	ld	(bc), a
                            433 ;source_code/aes128.c:57: temp = state[2];
   019B DD 5E 04      [19]  434 	ld	e, 4 (ix)
   019E DD 56 05      [19]  435 	ld	d, 5 (ix)
   01A1 13            [ 6]  436 	inc	de
   01A2 13            [ 6]  437 	inc	de
   01A3 1A            [ 7]  438 	ld	a, (de)
   01A4 DD 77 FF      [19]  439 	ld	-1 (ix), a
                            440 ;source_code/aes128.c:58: state[2] = state[10];
   01A7 DD 7E 04      [19]  441 	ld	a, 4 (ix)
   01AA C6 0A         [ 7]  442 	add	a, #0x0a
   01AC 4F            [ 4]  443 	ld	c, a
   01AD DD 7E 05      [19]  444 	ld	a, 5 (ix)
   01B0 CE 00         [ 7]  445 	adc	a, #0x00
   01B2 47            [ 4]  446 	ld	b, a
   01B3 0A            [ 7]  447 	ld	a, (bc)
   01B4 12            [ 7]  448 	ld	(de), a
                            449 ;source_code/aes128.c:59: state[10] = temp;
   01B5 DD 7E FF      [19]  450 	ld	a, -1 (ix)
   01B8 02            [ 7]  451 	ld	(bc), a
                            452 ;source_code/aes128.c:60: temp = state[6];
   01B9 DD 7E 04      [19]  453 	ld	a, 4 (ix)
   01BC C6 06         [ 7]  454 	add	a, #0x06
   01BE 5F            [ 4]  455 	ld	e, a
   01BF DD 7E 05      [19]  456 	ld	a, 5 (ix)
   01C2 CE 00         [ 7]  457 	adc	a, #0x00
   01C4 57            [ 4]  458 	ld	d, a
   01C5 1A            [ 7]  459 	ld	a, (de)
   01C6 DD 77 FF      [19]  460 	ld	-1 (ix), a
                            461 ;source_code/aes128.c:61: state[6] = state[14];
   01C9 DD 7E 04      [19]  462 	ld	a, 4 (ix)
   01CC C6 0E         [ 7]  463 	add	a, #0x0e
   01CE 4F            [ 4]  464 	ld	c, a
   01CF DD 7E 05      [19]  465 	ld	a, 5 (ix)
   01D2 CE 00         [ 7]  466 	adc	a, #0x00
   01D4 47            [ 4]  467 	ld	b, a
   01D5 0A            [ 7]  468 	ld	a, (bc)
   01D6 12            [ 7]  469 	ld	(de), a
                            470 ;source_code/aes128.c:62: state[14] = temp;
   01D7 DD 7E FF      [19]  471 	ld	a, -1 (ix)
   01DA 02            [ 7]  472 	ld	(bc), a
                            473 ;source_code/aes128.c:64: temp = state[15];
   01DB DD 7E 04      [19]  474 	ld	a, 4 (ix)
   01DE C6 0F         [ 7]  475 	add	a, #0x0f
   01E0 5F            [ 4]  476 	ld	e, a
   01E1 DD 7E 05      [19]  477 	ld	a, 5 (ix)
   01E4 CE 00         [ 7]  478 	adc	a, #0x00
   01E6 57            [ 4]  479 	ld	d, a
   01E7 1A            [ 7]  480 	ld	a, (de)
   01E8 DD 77 FF      [19]  481 	ld	-1 (ix), a
                            482 ;source_code/aes128.c:65: state[15] = state[11];
   01EB DD 7E 04      [19]  483 	ld	a, 4 (ix)
   01EE C6 0B         [ 7]  484 	add	a, #0x0b
   01F0 4F            [ 4]  485 	ld	c, a
   01F1 DD 7E 05      [19]  486 	ld	a, 5 (ix)
   01F4 CE 00         [ 7]  487 	adc	a, #0x00
   01F6 47            [ 4]  488 	ld	b, a
   01F7 0A            [ 7]  489 	ld	a, (bc)
   01F8 12            [ 7]  490 	ld	(de), a
                            491 ;source_code/aes128.c:66: state[11] = state[7];
   01F9 DD 7E 04      [19]  492 	ld	a, 4 (ix)
   01FC C6 07         [ 7]  493 	add	a, #0x07
   01FE 5F            [ 4]  494 	ld	e, a
   01FF DD 7E 05      [19]  495 	ld	a, 5 (ix)
   0202 CE 00         [ 7]  496 	adc	a, #0x00
   0204 57            [ 4]  497 	ld	d, a
   0205 1A            [ 7]  498 	ld	a, (de)
   0206 02            [ 7]  499 	ld	(bc), a
                            500 ;source_code/aes128.c:67: state[7] = state[3];
   0207 DD 4E 04      [19]  501 	ld	c, 4 (ix)
   020A DD 46 05      [19]  502 	ld	b, 5 (ix)
   020D 03            [ 6]  503 	inc	bc
   020E 03            [ 6]  504 	inc	bc
   020F 03            [ 6]  505 	inc	bc
   0210 0A            [ 7]  506 	ld	a, (bc)
   0211 12            [ 7]  507 	ld	(de), a
                            508 ;source_code/aes128.c:68: state[3] = temp;
   0212 DD 7E FF      [19]  509 	ld	a, -1 (ix)
   0215 02            [ 7]  510 	ld	(bc), a
                            511 ;source_code/aes128.c:69: }
   0216 33            [ 6]  512 	inc	sp
   0217 DD E1         [14]  513 	pop	ix
   0219 C9            [10]  514 	ret
                            515 ;source_code/aes128.c:71: static void mix_columns(uint8_t *state) {
                            516 ;	---------------------------------
                            517 ; Function mix_columns
                            518 ; ---------------------------------
   021A                     519 _mix_columns:
   021A CDr00r00      [17]  520 	call	___sdcc_enter_ix
   021D 21 E2 FF      [10]  521 	ld	hl, #-30
   0220 39            [11]  522 	add	hl, sp
   0221 F9            [ 6]  523 	ld	sp, hl
                            524 ;source_code/aes128.c:74: for (int i = 0; i < 4; i++) {
   0222 21 02 00      [10]  525 	ld	hl, #2
   0225 39            [11]  526 	add	hl, sp
   0226 DD 75 F4      [19]  527 	ld	-12 (ix), l
   0229 DD 74 F5      [19]  528 	ld	-11 (ix), h
   022C 01 00 00      [10]  529 	ld	bc, #0x0000
   022F                     530 00103$:
   022F 79            [ 4]  531 	ld	a, c
   0230 D6 04         [ 7]  532 	sub	a, #0x04
   0232 78            [ 4]  533 	ld	a, b
   0233 17            [ 4]  534 	rla
   0234 3F            [ 4]  535 	ccf
   0235 1F            [ 4]  536 	rra
   0236 DE 80         [ 7]  537 	sbc	a, #0x80
   0238 D2r10r04      [10]  538 	jp	NC, 00101$
                            539 ;source_code/aes128.c:75: int idx = i * 4;
   023B 59            [ 4]  540 	ld	e, c
   023C 50            [ 4]  541 	ld	d, b
   023D CB 23         [ 8]  542 	sla	e
   023F CB 12         [ 8]  543 	rl	d
   0241 CB 23         [ 8]  544 	sla	e
   0243 CB 12         [ 8]  545 	rl	d
                            546 ;source_code/aes128.c:76: tmp[idx + 0] = (uint8_t)(xtime(state[idx + 0]) ^ xtime(state[idx + 1]) ^ state[idx + 1] ^ state[idx + 2] ^ state[idx + 3]);
   0245 DD 73 F6      [19]  547 	ld	-10 (ix), e
   0248 7B            [ 4]  548 	ld	a, e
   0249 6F            [ 4]  549 	ld	l, a
   024A 17            [ 4]  550 	rla
   024B 9F            [ 4]  551 	sbc	a, a
   024C 67            [ 4]  552 	ld	h, a
   024D 7D            [ 4]  553 	ld	a, l
   024E DD 86 F4      [19]  554 	add	a, -12 (ix)
   0251 DD 77 E2      [19]  555 	ld	-30 (ix), a
   0254 7C            [ 4]  556 	ld	a, h
   0255 DD 8E F5      [19]  557 	adc	a, -11 (ix)
   0258 DD 77 E3      [19]  558 	ld	-29 (ix), a
   025B DD 7E 04      [19]  559 	ld	a, 4 (ix)
   025E 83            [ 4]  560 	add	a, e
   025F DD 77 F7      [19]  561 	ld	-9 (ix), a
   0262 DD 7E 05      [19]  562 	ld	a, 5 (ix)
   0265 8A            [ 4]  563 	adc	a, d
   0266 DD 77 F8      [19]  564 	ld	-8 (ix), a
   0269 DD 6E F7      [19]  565 	ld	l, -9 (ix)
   026C DD 66 F8      [19]  566 	ld	h, -8 (ix)
   026F 7E            [ 7]  567 	ld	a, (hl)
   0270 C5            [11]  568 	push	bc
   0271 D5            [11]  569 	push	de
   0272 F5            [11]  570 	push	af
   0273 33            [ 6]  571 	inc	sp
   0274 CDr00r00      [17]  572 	call	_xtime
   0277 33            [ 6]  573 	inc	sp
   0278 DD 75 FD      [19]  574 	ld	-3 (ix), l
   027B D1            [10]  575 	pop	de
   027C C1            [10]  576 	pop	bc
   027D 21 01 00      [10]  577 	ld	hl, #0x0001
   0280 19            [11]  578 	add	hl, de
   0281 DD 75 FE      [19]  579 	ld	-2 (ix), l
   0284 DD 74 FF      [19]  580 	ld	-1 (ix), h
   0287 DD 7E FE      [19]  581 	ld	a, -2 (ix)
   028A DD 86 04      [19]  582 	add	a, 4 (ix)
   028D DD 77 F9      [19]  583 	ld	-7 (ix), a
   0290 DD 7E FF      [19]  584 	ld	a, -1 (ix)
   0293 DD 8E 05      [19]  585 	adc	a, 5 (ix)
   0296 DD 77 FA      [19]  586 	ld	-6 (ix), a
   0299 DD 6E F9      [19]  587 	ld	l, -7 (ix)
   029C DD 66 FA      [19]  588 	ld	h, -6 (ix)
   029F 7E            [ 7]  589 	ld	a, (hl)
   02A0 C5            [11]  590 	push	bc
   02A1 D5            [11]  591 	push	de
   02A2 F5            [11]  592 	push	af
   02A3 33            [ 6]  593 	inc	sp
   02A4 CDr00r00      [17]  594 	call	_xtime
   02A7 33            [ 6]  595 	inc	sp
   02A8 7D            [ 4]  596 	ld	a, l
   02A9 D1            [10]  597 	pop	de
   02AA C1            [10]  598 	pop	bc
   02AB DD AE FD      [19]  599 	xor	a, -3 (ix)
   02AE DD 6E F9      [19]  600 	ld	l, -7 (ix)
   02B1 DD 66 FA      [19]  601 	ld	h, -6 (ix)
   02B4 6E            [ 7]  602 	ld	l, (hl)
   02B5 AD            [ 4]  603 	xor	a, l
   02B6 DD 77 FF      [19]  604 	ld	-1 (ix), a
   02B9 21 02 00      [10]  605 	ld	hl, #0x0002
   02BC 19            [11]  606 	add	hl, de
   02BD DD 75 FD      [19]  607 	ld	-3 (ix), l
   02C0 DD 74 FE      [19]  608 	ld	-2 (ix), h
   02C3 DD 7E FD      [19]  609 	ld	a, -3 (ix)
   02C6 DD 86 04      [19]  610 	add	a, 4 (ix)
   02C9 DD 77 FB      [19]  611 	ld	-5 (ix), a
   02CC DD 7E FE      [19]  612 	ld	a, -2 (ix)
   02CF DD 8E 05      [19]  613 	adc	a, 5 (ix)
   02D2 DD 77 FC      [19]  614 	ld	-4 (ix), a
   02D5 DD 6E FB      [19]  615 	ld	l, -5 (ix)
   02D8 DD 66 FC      [19]  616 	ld	h, -4 (ix)
   02DB 7E            [ 7]  617 	ld	a, (hl)
   02DC DD AE FF      [19]  618 	xor	a, -1 (ix)
   02DF DD 77 FF      [19]  619 	ld	-1 (ix), a
   02E2 13            [ 6]  620 	inc	de
   02E3 13            [ 6]  621 	inc	de
   02E4 13            [ 6]  622 	inc	de
   02E5 7B            [ 4]  623 	ld	a, e
   02E6 DD 86 04      [19]  624 	add	a, 4 (ix)
   02E9 DD 77 FD      [19]  625 	ld	-3 (ix), a
   02EC 7A            [ 4]  626 	ld	a, d
   02ED DD 8E 05      [19]  627 	adc	a, 5 (ix)
   02F0 DD 77 FE      [19]  628 	ld	-2 (ix), a
   02F3 DD 6E FD      [19]  629 	ld	l, -3 (ix)
   02F6 DD 66 FE      [19]  630 	ld	h, -2 (ix)
   02F9 7E            [ 7]  631 	ld	a, (hl)
   02FA DD AE FF      [19]  632 	xor	a, -1 (ix)
   02FD E1            [10]  633 	pop	hl
   02FE E5            [11]  634 	push	hl
   02FF 77            [ 7]  635 	ld	(hl), a
                            636 ;source_code/aes128.c:77: tmp[idx + 1] = (uint8_t)(state[idx + 0] ^ xtime(state[idx + 1]) ^ xtime(state[idx + 2]) ^ state[idx + 2] ^ state[idx + 3]);
   0300 DD 7E F6      [19]  637 	ld	a, -10 (ix)
   0303 3C            [ 4]  638 	inc	a
   0304 5F            [ 4]  639 	ld	e, a
   0305 17            [ 4]  640 	rla
   0306 9F            [ 4]  641 	sbc	a, a
   0307 57            [ 4]  642 	ld	d, a
   0308 7B            [ 4]  643 	ld	a, e
   0309 DD 86 F4      [19]  644 	add	a, -12 (ix)
   030C 5F            [ 4]  645 	ld	e, a
   030D 7A            [ 4]  646 	ld	a, d
   030E DD 8E F5      [19]  647 	adc	a, -11 (ix)
   0311 57            [ 4]  648 	ld	d, a
   0312 DD 6E F7      [19]  649 	ld	l, -9 (ix)
   0315 DD 66 F8      [19]  650 	ld	h, -8 (ix)
   0318 7E            [ 7]  651 	ld	a, (hl)
   0319 DD 77 FF      [19]  652 	ld	-1 (ix), a
   031C DD 6E F9      [19]  653 	ld	l, -7 (ix)
   031F DD 66 FA      [19]  654 	ld	h, -6 (ix)
   0322 7E            [ 7]  655 	ld	a, (hl)
   0323 C5            [11]  656 	push	bc
   0324 D5            [11]  657 	push	de
   0325 F5            [11]  658 	push	af
   0326 33            [ 6]  659 	inc	sp
   0327 CDr00r00      [17]  660 	call	_xtime
   032A 33            [ 6]  661 	inc	sp
   032B 7D            [ 4]  662 	ld	a, l
   032C D1            [10]  663 	pop	de
   032D C1            [10]  664 	pop	bc
   032E DD AE FF      [19]  665 	xor	a, -1 (ix)
   0331 DD 77 FF      [19]  666 	ld	-1 (ix), a
   0334 DD 6E FB      [19]  667 	ld	l, -5 (ix)
   0337 DD 66 FC      [19]  668 	ld	h, -4 (ix)
   033A 7E            [ 7]  669 	ld	a, (hl)
   033B C5            [11]  670 	push	bc
   033C D5            [11]  671 	push	de
   033D F5            [11]  672 	push	af
   033E 33            [ 6]  673 	inc	sp
   033F CDr00r00      [17]  674 	call	_xtime
   0342 33            [ 6]  675 	inc	sp
   0343 7D            [ 4]  676 	ld	a, l
   0344 D1            [10]  677 	pop	de
   0345 C1            [10]  678 	pop	bc
   0346 DD AE FF      [19]  679 	xor	a, -1 (ix)
   0349 DD 6E FB      [19]  680 	ld	l, -5 (ix)
   034C DD 66 FC      [19]  681 	ld	h, -4 (ix)
   034F 6E            [ 7]  682 	ld	l, (hl)
   0350 AD            [ 4]  683 	xor	a, l
   0351 DD 6E FD      [19]  684 	ld	l, -3 (ix)
   0354 DD 66 FE      [19]  685 	ld	h, -2 (ix)
   0357 6E            [ 7]  686 	ld	l, (hl)
   0358 AD            [ 4]  687 	xor	a, l
   0359 12            [ 7]  688 	ld	(de), a
                            689 ;source_code/aes128.c:78: tmp[idx + 2] = (uint8_t)(state[idx + 0] ^ state[idx + 1] ^ xtime(state[idx + 2]) ^ xtime(state[idx + 3]) ^ state[idx + 3]);
   035A DD 7E F6      [19]  690 	ld	a, -10 (ix)
   035D 3C            [ 4]  691 	inc	a
   035E 3C            [ 4]  692 	inc	a
   035F 5F            [ 4]  693 	ld	e, a
   0360 17            [ 4]  694 	rla
   0361 9F            [ 4]  695 	sbc	a, a
   0362 57            [ 4]  696 	ld	d, a
   0363 7B            [ 4]  697 	ld	a, e
   0364 DD 86 F4      [19]  698 	add	a, -12 (ix)
   0367 5F            [ 4]  699 	ld	e, a
   0368 7A            [ 4]  700 	ld	a, d
   0369 DD 8E F5      [19]  701 	adc	a, -11 (ix)
   036C 57            [ 4]  702 	ld	d, a
   036D DD 6E F7      [19]  703 	ld	l, -9 (ix)
   0370 DD 66 F8      [19]  704 	ld	h, -8 (ix)
   0373 7E            [ 7]  705 	ld	a, (hl)
   0374 DD 6E F9      [19]  706 	ld	l, -7 (ix)
   0377 DD 66 FA      [19]  707 	ld	h, -6 (ix)
   037A 6E            [ 7]  708 	ld	l, (hl)
   037B AD            [ 4]  709 	xor	a, l
   037C DD 77 FF      [19]  710 	ld	-1 (ix), a
   037F DD 6E FB      [19]  711 	ld	l, -5 (ix)
   0382 DD 66 FC      [19]  712 	ld	h, -4 (ix)
   0385 7E            [ 7]  713 	ld	a, (hl)
   0386 C5            [11]  714 	push	bc
   0387 D5            [11]  715 	push	de
   0388 F5            [11]  716 	push	af
   0389 33            [ 6]  717 	inc	sp
   038A CDr00r00      [17]  718 	call	_xtime
   038D 33            [ 6]  719 	inc	sp
   038E 7D            [ 4]  720 	ld	a, l
   038F D1            [10]  721 	pop	de
   0390 C1            [10]  722 	pop	bc
   0391 DD AE FF      [19]  723 	xor	a, -1 (ix)
   0394 DD 77 FF      [19]  724 	ld	-1 (ix), a
   0397 DD 6E FD      [19]  725 	ld	l, -3 (ix)
   039A DD 66 FE      [19]  726 	ld	h, -2 (ix)
   039D 7E            [ 7]  727 	ld	a, (hl)
   039E C5            [11]  728 	push	bc
   039F D5            [11]  729 	push	de
   03A0 F5            [11]  730 	push	af
   03A1 33            [ 6]  731 	inc	sp
   03A2 CDr00r00      [17]  732 	call	_xtime
   03A5 33            [ 6]  733 	inc	sp
   03A6 7D            [ 4]  734 	ld	a, l
   03A7 D1            [10]  735 	pop	de
   03A8 C1            [10]  736 	pop	bc
   03A9 DD AE FF      [19]  737 	xor	a, -1 (ix)
   03AC DD 6E FD      [19]  738 	ld	l, -3 (ix)
   03AF DD 66 FE      [19]  739 	ld	h, -2 (ix)
   03B2 6E            [ 7]  740 	ld	l, (hl)
   03B3 AD            [ 4]  741 	xor	a, l
   03B4 12            [ 7]  742 	ld	(de), a
                            743 ;source_code/aes128.c:79: tmp[idx + 3] = (uint8_t)(xtime(state[idx + 0]) ^ state[idx + 0] ^ state[idx + 1] ^ state[idx + 2] ^ xtime(state[idx + 3]));
   03B5 DD 7E F6      [19]  744 	ld	a, -10 (ix)
   03B8 3C            [ 4]  745 	inc	a
   03B9 3C            [ 4]  746 	inc	a
   03BA 3C            [ 4]  747 	inc	a
   03BB 5F            [ 4]  748 	ld	e, a
   03BC 17            [ 4]  749 	rla
   03BD 9F            [ 4]  750 	sbc	a, a
   03BE 57            [ 4]  751 	ld	d, a
   03BF 7B            [ 4]  752 	ld	a, e
   03C0 DD 86 F4      [19]  753 	add	a, -12 (ix)
   03C3 5F            [ 4]  754 	ld	e, a
   03C4 7A            [ 4]  755 	ld	a, d
   03C5 DD 8E F5      [19]  756 	adc	a, -11 (ix)
   03C8 57            [ 4]  757 	ld	d, a
   03C9 DD 6E F7      [19]  758 	ld	l, -9 (ix)
   03CC DD 66 F8      [19]  759 	ld	h, -8 (ix)
   03CF 7E            [ 7]  760 	ld	a, (hl)
   03D0 C5            [11]  761 	push	bc
   03D1 D5            [11]  762 	push	de
   03D2 F5            [11]  763 	push	af
   03D3 33            [ 6]  764 	inc	sp
   03D4 CDr00r00      [17]  765 	call	_xtime
   03D7 33            [ 6]  766 	inc	sp
   03D8 7D            [ 4]  767 	ld	a, l
   03D9 D1            [10]  768 	pop	de
   03DA C1            [10]  769 	pop	bc
   03DB DD 6E F7      [19]  770 	ld	l, -9 (ix)
   03DE DD 66 F8      [19]  771 	ld	h, -8 (ix)
   03E1 6E            [ 7]  772 	ld	l, (hl)
   03E2 AD            [ 4]  773 	xor	a, l
   03E3 DD 6E F9      [19]  774 	ld	l, -7 (ix)
   03E6 DD 66 FA      [19]  775 	ld	h, -6 (ix)
   03E9 6E            [ 7]  776 	ld	l, (hl)
   03EA AD            [ 4]  777 	xor	a, l
   03EB DD 6E FB      [19]  778 	ld	l, -5 (ix)
   03EE DD 66 FC      [19]  779 	ld	h, -4 (ix)
   03F1 6E            [ 7]  780 	ld	l, (hl)
   03F2 AD            [ 4]  781 	xor	a, l
   03F3 DD 77 FF      [19]  782 	ld	-1 (ix), a
   03F6 DD 6E FD      [19]  783 	ld	l, -3 (ix)
   03F9 DD 66 FE      [19]  784 	ld	h, -2 (ix)
   03FC 7E            [ 7]  785 	ld	a, (hl)
   03FD C5            [11]  786 	push	bc
   03FE D5            [11]  787 	push	de
   03FF F5            [11]  788 	push	af
   0400 33            [ 6]  789 	inc	sp
   0401 CDr00r00      [17]  790 	call	_xtime
   0404 33            [ 6]  791 	inc	sp
   0405 7D            [ 4]  792 	ld	a, l
   0406 D1            [10]  793 	pop	de
   0407 C1            [10]  794 	pop	bc
   0408 DD AE FF      [19]  795 	xor	a, -1 (ix)
   040B 12            [ 7]  796 	ld	(de), a
                            797 ;source_code/aes128.c:74: for (int i = 0; i < 4; i++) {
   040C 03            [ 6]  798 	inc	bc
   040D C3r2Fr02      [10]  799 	jp	00103$
   0410                     800 00101$:
                            801 ;source_code/aes128.c:82: memcpy(state, tmp, 16);
   0410 DD 5E 04      [19]  802 	ld	e, 4 (ix)
   0413 DD 56 05      [19]  803 	ld	d, 5 (ix)
   0416 DD 6E F4      [19]  804 	ld	l, -12 (ix)
   0419 DD 66 F5      [19]  805 	ld	h, -11 (ix)
   041C 01 10 00      [10]  806 	ld	bc, #0x0010
   041F ED B0         [21]  807 	ldir
                            808 ;source_code/aes128.c:83: }
   0421 DD F9         [10]  809 	ld	sp, ix
   0423 DD E1         [14]  810 	pop	ix
   0425 C9            [10]  811 	ret
                            812 ;source_code/aes128.c:85: static void add_round_key(uint8_t *state, const uint8_t *round_key) {
                            813 ;	---------------------------------
                            814 ; Function add_round_key
                            815 ; ---------------------------------
   0426                     816 _add_round_key:
   0426 CDr00r00      [17]  817 	call	___sdcc_enter_ix
   0429 3B            [ 6]  818 	dec	sp
                            819 ;source_code/aes128.c:86: for (int i = 0; i < 16; i++) {
   042A 01 00 00      [10]  820 	ld	bc, #0x0000
   042D                     821 00103$:
   042D 79            [ 4]  822 	ld	a, c
   042E D6 10         [ 7]  823 	sub	a, #0x10
   0430 78            [ 4]  824 	ld	a, b
   0431 17            [ 4]  825 	rla
   0432 3F            [ 4]  826 	ccf
   0433 1F            [ 4]  827 	rra
   0434 DE 80         [ 7]  828 	sbc	a, #0x80
   0436 30 1D         [12]  829 	jr	NC,00105$
                            830 ;source_code/aes128.c:87: state[i] ^= round_key[i];
   0438 DD 7E 04      [19]  831 	ld	a, 4 (ix)
   043B 81            [ 4]  832 	add	a, c
   043C 5F            [ 4]  833 	ld	e, a
   043D DD 7E 05      [19]  834 	ld	a, 5 (ix)
   0440 88            [ 4]  835 	adc	a, b
   0441 57            [ 4]  836 	ld	d, a
   0442 1A            [ 7]  837 	ld	a, (de)
   0443 DD 77 FF      [19]  838 	ld	-1 (ix), a
   0446 DD 6E 06      [19]  839 	ld	l, 6 (ix)
   0449 DD 66 07      [19]  840 	ld	h, 7 (ix)
   044C 09            [11]  841 	add	hl, bc
   044D 7E            [ 7]  842 	ld	a, (hl)
   044E DD AE FF      [19]  843 	xor	a, -1 (ix)
   0451 12            [ 7]  844 	ld	(de), a
                            845 ;source_code/aes128.c:86: for (int i = 0; i < 16; i++) {
   0452 03            [ 6]  846 	inc	bc
   0453 18 D8         [12]  847 	jr	00103$
   0455                     848 00105$:
                            849 ;source_code/aes128.c:89: }
   0455 33            [ 6]  850 	inc	sp
   0456 DD E1         [14]  851 	pop	ix
   0458 C9            [10]  852 	ret
                            853 ;source_code/aes128.c:91: static void key_expansion(const uint8_t *key, AES128_CTX *ctx) {
                            854 ;	---------------------------------
                            855 ; Function key_expansion
                            856 ; ---------------------------------
   0459                     857 _key_expansion:
   0459 CDr00r00      [17]  858 	call	___sdcc_enter_ix
   045C 21 F7 FF      [10]  859 	ld	hl, #-9
   045F 39            [11]  860 	add	hl, sp
   0460 F9            [ 6]  861 	ld	sp, hl
                            862 ;source_code/aes128.c:92: memcpy(ctx->round_keys[0], key, 16);
   0461 DD 4E 06      [19]  863 	ld	c, 6 (ix)
   0464 DD 46 07      [19]  864 	ld	b, 7 (ix)
   0467 59            [ 4]  865 	ld	e, c
   0468 50            [ 4]  866 	ld	d, b
   0469 DD 6E 04      [19]  867 	ld	l, 4 (ix)
   046C DD 66 05      [19]  868 	ld	h, 5 (ix)
   046F C5            [11]  869 	push	bc
   0470 01 10 00      [10]  870 	ld	bc, #0x0010
   0473 ED B0         [21]  871 	ldir
   0475 C1            [10]  872 	pop	bc
                            873 ;source_code/aes128.c:94: for (int round = 1; round <= AES_ROUNDS; round++) {
   0476 11 01 00      [10]  874 	ld	de, #0x0001
   0479                     875 00107$:
   0479 3E 0A         [ 7]  876 	ld	a, #0x0a
   047B BB            [ 4]  877 	cp	a, e
   047C 3E 00         [ 7]  878 	ld	a, #0x00
   047E 9A            [ 4]  879 	sbc	a, d
   047F E2r84r04      [10]  880 	jp	PO, 00133$
   0482 EE 80         [ 7]  881 	xor	a, #0x80
   0484                     882 00133$:
   0484 FArD2r05      [10]  883 	jp	M, 00109$
                            884 ;source_code/aes128.c:95: uint8_t *prev = ctx->round_keys[round - 1];
   0487 6B            [ 4]  885 	ld	l, e
   0488 62            [ 4]  886 	ld	h, d
   0489 2B            [ 6]  887 	dec	hl
   048A 29            [11]  888 	add	hl, hl
   048B 29            [11]  889 	add	hl, hl
   048C 29            [11]  890 	add	hl, hl
   048D 29            [11]  891 	add	hl, hl
   048E 09            [11]  892 	add	hl, bc
   048F 33            [ 6]  893 	inc	sp
   0490 33            [ 6]  894 	inc	sp
   0491 E5            [11]  895 	push	hl
                            896 ;source_code/aes128.c:96: uint8_t *curr = ctx->round_keys[round];
   0492 6B            [ 4]  897 	ld	l, e
   0493 62            [ 4]  898 	ld	h, d
   0494 29            [11]  899 	add	hl, hl
   0495 29            [11]  900 	add	hl, hl
   0496 29            [11]  901 	add	hl, hl
   0497 29            [11]  902 	add	hl, hl
   0498 09            [11]  903 	add	hl, bc
   0499 DD 75 F9      [19]  904 	ld	-7 (ix), l
   049C DD 74 FA      [19]  905 	ld	-6 (ix), h
                            906 ;source_code/aes128.c:98: curr[0] = prev[0] ^ sbox[prev[13]] ^ rcon[round];
   049F E1            [10]  907 	pop	hl
   04A0 E5            [11]  908 	push	hl
   04A1 7E            [ 7]  909 	ld	a, (hl)
   04A2 DD 77 FF      [19]  910 	ld	-1 (ix), a
   04A5 E1            [10]  911 	pop	hl
   04A6 E5            [11]  912 	push	hl
   04A7 C5            [11]  913 	push	bc
   04A8 01 0D 00      [10]  914 	ld	bc, #0x000d
   04AB 09            [11]  915 	add	hl, bc
   04AC C1            [10]  916 	pop	bc
   04AD 7E            [ 7]  917 	ld	a, (hl)
   04AE C6r27         [ 7]  918 	add	a, #<(_sbox)
   04B0 6F            [ 4]  919 	ld	l, a
   04B1 3E 00         [ 7]  920 	ld	a, #0x00
   04B3 CEs00         [ 7]  921 	adc	a, #>(_sbox)
   04B5 67            [ 4]  922 	ld	h, a
   04B6 7E            [ 7]  923 	ld	a, (hl)
   04B7 DD AE FF      [19]  924 	xor	a, -1 (ix)
   04BA DD 77 FF      [19]  925 	ld	-1 (ix), a
   04BD 21r27r01      [10]  926 	ld	hl, #_rcon
   04C0 19            [11]  927 	add	hl, de
   04C1 7E            [ 7]  928 	ld	a, (hl)
   04C2 DD AE FF      [19]  929 	xor	a, -1 (ix)
   04C5 DD 6E F9      [19]  930 	ld	l, -7 (ix)
   04C8 DD 66 FA      [19]  931 	ld	h, -6 (ix)
   04CB 77            [ 7]  932 	ld	(hl), a
                            933 ;source_code/aes128.c:99: curr[1] = prev[1] ^ sbox[prev[14]];
   04CC DD 7E F9      [19]  934 	ld	a, -7 (ix)
   04CF C6 01         [ 7]  935 	add	a, #0x01
   04D1 DD 77 FD      [19]  936 	ld	-3 (ix), a
   04D4 DD 7E FA      [19]  937 	ld	a, -6 (ix)
   04D7 CE 00         [ 7]  938 	adc	a, #0x00
   04D9 DD 77 FE      [19]  939 	ld	-2 (ix), a
   04DC E1            [10]  940 	pop	hl
   04DD E5            [11]  941 	push	hl
   04DE 23            [ 6]  942 	inc	hl
   04DF 7E            [ 7]  943 	ld	a, (hl)
   04E0 DD 77 FF      [19]  944 	ld	-1 (ix), a
   04E3 E1            [10]  945 	pop	hl
   04E4 E5            [11]  946 	push	hl
   04E5 C5            [11]  947 	push	bc
   04E6 01 0E 00      [10]  948 	ld	bc, #0x000e
   04E9 09            [11]  949 	add	hl, bc
   04EA C1            [10]  950 	pop	bc
   04EB 7E            [ 7]  951 	ld	a, (hl)
   04EC C6r27         [ 7]  952 	add	a, #<(_sbox)
   04EE 6F            [ 4]  953 	ld	l, a
   04EF 3E 00         [ 7]  954 	ld	a, #0x00
   04F1 CEs00         [ 7]  955 	adc	a, #>(_sbox)
   04F3 67            [ 4]  956 	ld	h, a
   04F4 7E            [ 7]  957 	ld	a, (hl)
   04F5 DD AE FF      [19]  958 	xor	a, -1 (ix)
   04F8 DD 6E FD      [19]  959 	ld	l, -3 (ix)
   04FB DD 66 FE      [19]  960 	ld	h, -2 (ix)
   04FE 77            [ 7]  961 	ld	(hl), a
                            962 ;source_code/aes128.c:100: curr[2] = prev[2] ^ sbox[prev[15]];
   04FF DD 7E F9      [19]  963 	ld	a, -7 (ix)
   0502 C6 02         [ 7]  964 	add	a, #0x02
   0504 DD 77 FD      [19]  965 	ld	-3 (ix), a
   0507 DD 7E FA      [19]  966 	ld	a, -6 (ix)
   050A CE 00         [ 7]  967 	adc	a, #0x00
   050C DD 77 FE      [19]  968 	ld	-2 (ix), a
   050F E1            [10]  969 	pop	hl
   0510 E5            [11]  970 	push	hl
   0511 23            [ 6]  971 	inc	hl
   0512 23            [ 6]  972 	inc	hl
   0513 7E            [ 7]  973 	ld	a, (hl)
   0514 DD 77 FF      [19]  974 	ld	-1 (ix), a
   0517 E1            [10]  975 	pop	hl
   0518 E5            [11]  976 	push	hl
   0519 C5            [11]  977 	push	bc
   051A 01 0F 00      [10]  978 	ld	bc, #0x000f
   051D 09            [11]  979 	add	hl, bc
   051E C1            [10]  980 	pop	bc
   051F 7E            [ 7]  981 	ld	a, (hl)
   0520 C6r27         [ 7]  982 	add	a, #<(_sbox)
   0522 6F            [ 4]  983 	ld	l, a
   0523 3E 00         [ 7]  984 	ld	a, #0x00
   0525 CEs00         [ 7]  985 	adc	a, #>(_sbox)
   0527 67            [ 4]  986 	ld	h, a
   0528 7E            [ 7]  987 	ld	a, (hl)
   0529 DD AE FF      [19]  988 	xor	a, -1 (ix)
   052C DD 6E FD      [19]  989 	ld	l, -3 (ix)
   052F DD 66 FE      [19]  990 	ld	h, -2 (ix)
   0532 77            [ 7]  991 	ld	(hl), a
                            992 ;source_code/aes128.c:101: curr[3] = prev[3] ^ sbox[prev[12]];
   0533 DD 7E F9      [19]  993 	ld	a, -7 (ix)
   0536 C6 03         [ 7]  994 	add	a, #0x03
   0538 DD 77 FD      [19]  995 	ld	-3 (ix), a
   053B DD 7E FA      [19]  996 	ld	a, -6 (ix)
   053E CE 00         [ 7]  997 	adc	a, #0x00
   0540 DD 77 FE      [19]  998 	ld	-2 (ix), a
   0543 E1            [10]  999 	pop	hl
   0544 E5            [11] 1000 	push	hl
   0545 23            [ 6] 1001 	inc	hl
   0546 23            [ 6] 1002 	inc	hl
   0547 23            [ 6] 1003 	inc	hl
   0548 7E            [ 7] 1004 	ld	a, (hl)
   0549 DD 77 FF      [19] 1005 	ld	-1 (ix), a
   054C E1            [10] 1006 	pop	hl
   054D E5            [11] 1007 	push	hl
   054E C5            [11] 1008 	push	bc
   054F 01 0C 00      [10] 1009 	ld	bc, #0x000c
   0552 09            [11] 1010 	add	hl, bc
   0553 C1            [10] 1011 	pop	bc
   0554 7E            [ 7] 1012 	ld	a, (hl)
   0555 C6r27         [ 7] 1013 	add	a, #<(_sbox)
   0557 6F            [ 4] 1014 	ld	l, a
   0558 3E 00         [ 7] 1015 	ld	a, #0x00
   055A CEs00         [ 7] 1016 	adc	a, #>(_sbox)
   055C 67            [ 4] 1017 	ld	h, a
   055D 7E            [ 7] 1018 	ld	a, (hl)
   055E DD AE FF      [19] 1019 	xor	a, -1 (ix)
   0561 DD 6E FD      [19] 1020 	ld	l, -3 (ix)
   0564 DD 66 FE      [19] 1021 	ld	h, -2 (ix)
   0567 77            [ 7] 1022 	ld	(hl), a
                           1023 ;source_code/aes128.c:103: for (int i = 4; i < 16; i++) {
   0568 DD 36 FE 04   [19] 1024 	ld	-2 (ix), #0x04
   056C AF            [ 4] 1025 	xor	a, a
   056D DD 77 FF      [19] 1026 	ld	-1 (ix), a
   0570                    1027 00104$:
   0570 DD 7E FE      [19] 1028 	ld	a, -2 (ix)
   0573 D6 10         [ 7] 1029 	sub	a, #0x10
   0575 DD 7E FF      [19] 1030 	ld	a, -1 (ix)
   0578 17            [ 4] 1031 	rla
   0579 3F            [ 4] 1032 	ccf
   057A 1F            [ 4] 1033 	rra
   057B DE 80         [ 7] 1034 	sbc	a, #0x80
   057D 30 4F         [12] 1035 	jr	NC,00108$
                           1036 ;source_code/aes128.c:104: curr[i] = prev[i] ^ curr[i - 4];
   057F DD 7E F9      [19] 1037 	ld	a, -7 (ix)
   0582 DD 86 FE      [19] 1038 	add	a, -2 (ix)
   0585 DD 77 FB      [19] 1039 	ld	-5 (ix), a
   0588 DD 7E FA      [19] 1040 	ld	a, -6 (ix)
   058B DD 8E FF      [19] 1041 	adc	a, -1 (ix)
   058E DD 77 FC      [19] 1042 	ld	-4 (ix), a
   0591 DD 7E F7      [19] 1043 	ld	a, -9 (ix)
   0594 DD 86 FE      [19] 1044 	add	a, -2 (ix)
   0597 6F            [ 4] 1045 	ld	l, a
   0598 DD 7E F8      [19] 1046 	ld	a, -8 (ix)
   059B DD 8E FF      [19] 1047 	adc	a, -1 (ix)
   059E 67            [ 4] 1048 	ld	h, a
   059F 7E            [ 7] 1049 	ld	a, (hl)
   05A0 DD 77 FD      [19] 1050 	ld	-3 (ix), a
   05A3 DD 7E FE      [19] 1051 	ld	a, -2 (ix)
   05A6 C6 FC         [ 7] 1052 	add	a, #0xfc
   05A8 6F            [ 4] 1053 	ld	l, a
   05A9 DD 7E FF      [19] 1054 	ld	a, -1 (ix)
   05AC CE FF         [ 7] 1055 	adc	a, #0xff
   05AE 67            [ 4] 1056 	ld	h, a
   05AF 7D            [ 4] 1057 	ld	a, l
   05B0 DD 86 F9      [19] 1058 	add	a, -7 (ix)
   05B3 6F            [ 4] 1059 	ld	l, a
   05B4 7C            [ 4] 1060 	ld	a, h
   05B5 DD 8E FA      [19] 1061 	adc	a, -6 (ix)
   05B8 67            [ 4] 1062 	ld	h, a
   05B9 7E            [ 7] 1063 	ld	a, (hl)
   05BA DD AE FD      [19] 1064 	xor	a, -3 (ix)
   05BD DD 6E FB      [19] 1065 	ld	l, -5 (ix)
   05C0 DD 66 FC      [19] 1066 	ld	h, -4 (ix)
   05C3 77            [ 7] 1067 	ld	(hl), a
                           1068 ;source_code/aes128.c:103: for (int i = 4; i < 16; i++) {
   05C4 DD 34 FE      [23] 1069 	inc	-2 (ix)
   05C7 20 A7         [12] 1070 	jr	NZ,00104$
   05C9 DD 34 FF      [23] 1071 	inc	-1 (ix)
   05CC 18 A2         [12] 1072 	jr	00104$
   05CE                    1073 00108$:
                           1074 ;source_code/aes128.c:94: for (int round = 1; round <= AES_ROUNDS; round++) {
   05CE 13            [ 6] 1075 	inc	de
   05CF C3r79r04      [10] 1076 	jp	00107$
   05D2                    1077 00109$:
                           1078 ;source_code/aes128.c:107: }
   05D2 DD F9         [10] 1079 	ld	sp, ix
   05D4 DD E1         [14] 1080 	pop	ix
   05D6 C9            [10] 1081 	ret
                           1082 ;source_code/aes128.c:109: void aes128_encrypt(const uint8_t *plaintext, uint8_t *ciphertext, const uint8_t *key) {
                           1083 ;	---------------------------------
                           1084 ; Function aes128_encrypt
                           1085 ; ---------------------------------
   05D7                    1086 _aes128_encrypt::
   05D7 CDr00r00      [17] 1087 	call	___sdcc_enter_ix
   05DA 21 34 FF      [10] 1088 	ld	hl, #-204
   05DD 39            [11] 1089 	add	hl, sp
   05DE F9            [ 6] 1090 	ld	sp, hl
                           1091 ;source_code/aes128.c:113: key_expansion(key, &ctx);
   05DF 21 00 00      [10] 1092 	ld	hl, #0
   05E2 39            [11] 1093 	add	hl, sp
   05E3 DD 75 F4      [19] 1094 	ld	-12 (ix), l
   05E6 DD 74 F5      [19] 1095 	ld	-11 (ix), h
   05E9 E5            [11] 1096 	push	hl
   05EA DD 6E 08      [19] 1097 	ld	l, 8 (ix)
   05ED DD 66 09      [19] 1098 	ld	h, 9 (ix)
   05F0 E5            [11] 1099 	push	hl
   05F1 CDr59r04      [17] 1100 	call	_key_expansion
   05F4 F1            [10] 1101 	pop	af
   05F5 F1            [10] 1102 	pop	af
                           1103 ;source_code/aes128.c:114: memcpy(state, plaintext, 16);
   05F6 21 B0 00      [10] 1104 	ld	hl, #176
   05F9 39            [11] 1105 	add	hl, sp
   05FA 4D            [ 4] 1106 	ld	c, l
   05FB 44            [ 4] 1107 	ld	b, h
   05FC 59            [ 4] 1108 	ld	e, c
   05FD 50            [ 4] 1109 	ld	d, b
   05FE DD 6E 04      [19] 1110 	ld	l, 4 (ix)
   0601 DD 66 05      [19] 1111 	ld	h, 5 (ix)
   0604 C5            [11] 1112 	push	bc
   0605 01 10 00      [10] 1113 	ld	bc, #0x0010
   0608 ED B0         [21] 1114 	ldir
   060A C1            [10] 1115 	pop	bc
                           1116 ;source_code/aes128.c:116: add_round_key(state, ctx.round_keys[0]);
   060B DD 6E F4      [19] 1117 	ld	l, -12 (ix)
   060E DD 66 F5      [19] 1118 	ld	h, -11 (ix)
   0611 59            [ 4] 1119 	ld	e, c
   0612 50            [ 4] 1120 	ld	d, b
   0613 C5            [11] 1121 	push	bc
   0614 E5            [11] 1122 	push	hl
   0615 D5            [11] 1123 	push	de
   0616 CDr26r04      [17] 1124 	call	_add_round_key
   0619 F1            [10] 1125 	pop	af
   061A F1            [10] 1126 	pop	af
   061B C1            [10] 1127 	pop	bc
                           1128 ;source_code/aes128.c:118: for (int round = 1; round < AES_ROUNDS; round++) {
   061C DD 71 F6      [19] 1129 	ld	-10 (ix), c
   061F DD 70 F7      [19] 1130 	ld	-9 (ix), b
   0622 DD 71 F8      [19] 1131 	ld	-8 (ix), c
   0625 DD 70 F9      [19] 1132 	ld	-7 (ix), b
   0628 DD 71 FA      [19] 1133 	ld	-6 (ix), c
   062B DD 70 FB      [19] 1134 	ld	-5 (ix), b
   062E DD 71 FC      [19] 1135 	ld	-4 (ix), c
   0631 DD 70 FD      [19] 1136 	ld	-3 (ix), b
   0634 DD 36 FE 01   [19] 1137 	ld	-2 (ix), #0x01
   0638 AF            [ 4] 1138 	xor	a, a
   0639 DD 77 FF      [19] 1139 	ld	-1 (ix), a
   063C                    1140 00103$:
   063C DD 7E FE      [19] 1141 	ld	a, -2 (ix)
   063F D6 0A         [ 7] 1142 	sub	a, #0x0a
   0641 DD 7E FF      [19] 1143 	ld	a, -1 (ix)
   0644 17            [ 4] 1144 	rla
   0645 3F            [ 4] 1145 	ccf
   0646 1F            [ 4] 1146 	rra
   0647 DE 80         [ 7] 1147 	sbc	a, #0x80
   0649 30 60         [12] 1148 	jr	NC,00101$
                           1149 ;source_code/aes128.c:119: sub_bytes(state);
   064B DD 5E F6      [19] 1150 	ld	e, -10 (ix)
   064E DD 56 F7      [19] 1151 	ld	d, -9 (ix)
   0651 C5            [11] 1152 	push	bc
   0652 D5            [11] 1153 	push	de
   0653 CDr32r01      [17] 1154 	call	_sub_bytes
   0656 F1            [10] 1155 	pop	af
   0657 C1            [10] 1156 	pop	bc
                           1157 ;source_code/aes128.c:120: shift_rows(state);
   0658 DD 5E F8      [19] 1158 	ld	e, -8 (ix)
   065B DD 56 F9      [19] 1159 	ld	d, -7 (ix)
   065E C5            [11] 1160 	push	bc
   065F D5            [11] 1161 	push	de
   0660 CDr5Er01      [17] 1162 	call	_shift_rows
   0663 F1            [10] 1163 	pop	af
   0664 C1            [10] 1164 	pop	bc
                           1165 ;source_code/aes128.c:121: mix_columns(state);
   0665 DD 5E FA      [19] 1166 	ld	e, -6 (ix)
   0668 DD 56 FB      [19] 1167 	ld	d, -5 (ix)
   066B C5            [11] 1168 	push	bc
   066C D5            [11] 1169 	push	de
   066D CDr1Ar02      [17] 1170 	call	_mix_columns
   0670 F1            [10] 1171 	pop	af
   0671 C1            [10] 1172 	pop	bc
                           1173 ;source_code/aes128.c:122: add_round_key(state, ctx.round_keys[round]);
   0672 DD 5E FE      [19] 1174 	ld	e, -2 (ix)
   0675 DD 56 FF      [19] 1175 	ld	d, -1 (ix)
   0678 CB 23         [ 8] 1176 	sla	e
   067A CB 12         [ 8] 1177 	rl	d
   067C CB 23         [ 8] 1178 	sla	e
   067E CB 12         [ 8] 1179 	rl	d
   0680 CB 23         [ 8] 1180 	sla	e
   0682 CB 12         [ 8] 1181 	rl	d
   0684 CB 23         [ 8] 1182 	sla	e
   0686 CB 12         [ 8] 1183 	rl	d
   0688 7B            [ 4] 1184 	ld	a, e
   0689 DD 86 F4      [19] 1185 	add	a, -12 (ix)
   068C 5F            [ 4] 1186 	ld	e, a
   068D 7A            [ 4] 1187 	ld	a, d
   068E DD 8E F5      [19] 1188 	adc	a, -11 (ix)
   0691 57            [ 4] 1189 	ld	d, a
   0692 DD 6E FC      [19] 1190 	ld	l, -4 (ix)
   0695 DD 66 FD      [19] 1191 	ld	h, -3 (ix)
   0698 C5            [11] 1192 	push	bc
   0699 D5            [11] 1193 	push	de
   069A E5            [11] 1194 	push	hl
   069B CDr26r04      [17] 1195 	call	_add_round_key
   069E F1            [10] 1196 	pop	af
   069F F1            [10] 1197 	pop	af
   06A0 C1            [10] 1198 	pop	bc
                           1199 ;source_code/aes128.c:118: for (int round = 1; round < AES_ROUNDS; round++) {
   06A1 DD 34 FE      [23] 1200 	inc	-2 (ix)
   06A4 20 96         [12] 1201 	jr	NZ,00103$
   06A6 DD 34 FF      [23] 1202 	inc	-1 (ix)
   06A9 18 91         [12] 1203 	jr	00103$
   06AB                    1204 00101$:
                           1205 ;source_code/aes128.c:125: sub_bytes(state);
   06AB 59            [ 4] 1206 	ld	e, c
   06AC 50            [ 4] 1207 	ld	d, b
   06AD C5            [11] 1208 	push	bc
   06AE D5            [11] 1209 	push	de
   06AF CDr32r01      [17] 1210 	call	_sub_bytes
   06B2 F1            [10] 1211 	pop	af
   06B3 C1            [10] 1212 	pop	bc
                           1213 ;source_code/aes128.c:126: shift_rows(state);
   06B4 59            [ 4] 1214 	ld	e, c
   06B5 50            [ 4] 1215 	ld	d, b
   06B6 C5            [11] 1216 	push	bc
   06B7 D5            [11] 1217 	push	de
   06B8 CDr5Er01      [17] 1218 	call	_shift_rows
   06BB F1            [10] 1219 	pop	af
   06BC C1            [10] 1220 	pop	bc
                           1221 ;source_code/aes128.c:127: add_round_key(state, ctx.round_keys[AES_ROUNDS]);
   06BD DD 7E F4      [19] 1222 	ld	a, -12 (ix)
   06C0 C6 A0         [ 7] 1223 	add	a, #0xa0
   06C2 5F            [ 4] 1224 	ld	e, a
   06C3 DD 7E F5      [19] 1225 	ld	a, -11 (ix)
   06C6 CE 00         [ 7] 1226 	adc	a, #0x00
   06C8 57            [ 4] 1227 	ld	d, a
   06C9 69            [ 4] 1228 	ld	l, c
   06CA 60            [ 4] 1229 	ld	h, b
   06CB C5            [11] 1230 	push	bc
   06CC D5            [11] 1231 	push	de
   06CD E5            [11] 1232 	push	hl
   06CE CDr26r04      [17] 1233 	call	_add_round_key
   06D1 F1            [10] 1234 	pop	af
   06D2 F1            [10] 1235 	pop	af
   06D3 C1            [10] 1236 	pop	bc
                           1237 ;source_code/aes128.c:129: memcpy(ciphertext, state, 16);
   06D4 DD 5E 06      [19] 1238 	ld	e, 6 (ix)
   06D7 DD 56 07      [19] 1239 	ld	d, 7 (ix)
   06DA 69            [ 4] 1240 	ld	l, c
   06DB 60            [ 4] 1241 	ld	h, b
   06DC 01 10 00      [10] 1242 	ld	bc, #0x0010
   06DF ED B0         [21] 1243 	ldir
                           1244 ;source_code/aes128.c:130: }
   06E1 DD F9         [10] 1245 	ld	sp, ix
   06E3 DD E1         [14] 1246 	pop	ix
   06E5 C9            [10] 1247 	ret
                           1248 ;source_code/aes128.c:132: int main() {
                           1249 ;	---------------------------------
                           1250 ; Function main
                           1251 ; ---------------------------------
   06E6                    1252 _main::
   06E6 CDr00r00      [17] 1253 	call	___sdcc_enter_ix
   06E9 21 CC FF      [10] 1254 	ld	hl, #-52
   06EC 39            [11] 1255 	add	hl, sp
   06ED F9            [ 6] 1256 	ld	sp, hl
                           1257 ;source_code/aes128.c:133: uint8_t key[16] = {
   06EE 21 00 00      [10] 1258 	ld	hl, #0
   06F1 39            [11] 1259 	add	hl, sp
   06F2 EB            [ 4] 1260 	ex	de, hl
   06F3 3E 2B         [ 7] 1261 	ld	a, #0x2b
   06F5 12            [ 7] 1262 	ld	(de), a
   06F6 6B            [ 4] 1263 	ld	l, e
   06F7 62            [ 4] 1264 	ld	h, d
   06F8 23            [ 6] 1265 	inc	hl
   06F9 36 7E         [10] 1266 	ld	(hl), #0x7e
   06FB 6B            [ 4] 1267 	ld	l, e
   06FC 62            [ 4] 1268 	ld	h, d
   06FD 23            [ 6] 1269 	inc	hl
   06FE 23            [ 6] 1270 	inc	hl
   06FF 36 15         [10] 1271 	ld	(hl), #0x15
   0701 6B            [ 4] 1272 	ld	l, e
   0702 62            [ 4] 1273 	ld	h, d
   0703 23            [ 6] 1274 	inc	hl
   0704 23            [ 6] 1275 	inc	hl
   0705 23            [ 6] 1276 	inc	hl
   0706 36 16         [10] 1277 	ld	(hl), #0x16
   0708 21 04 00      [10] 1278 	ld	hl, #0x0004
   070B 19            [11] 1279 	add	hl, de
   070C 36 28         [10] 1280 	ld	(hl), #0x28
   070E 21 05 00      [10] 1281 	ld	hl, #0x0005
   0711 19            [11] 1282 	add	hl, de
   0712 36 AE         [10] 1283 	ld	(hl), #0xae
   0714 21 06 00      [10] 1284 	ld	hl, #0x0006
   0717 19            [11] 1285 	add	hl, de
   0718 36 D2         [10] 1286 	ld	(hl), #0xd2
   071A 21 07 00      [10] 1287 	ld	hl, #0x0007
   071D 19            [11] 1288 	add	hl, de
   071E 36 A6         [10] 1289 	ld	(hl), #0xa6
   0720 21 08 00      [10] 1290 	ld	hl, #0x0008
   0723 19            [11] 1291 	add	hl, de
   0724 36 AB         [10] 1292 	ld	(hl), #0xab
   0726 21 09 00      [10] 1293 	ld	hl, #0x0009
   0729 19            [11] 1294 	add	hl, de
   072A 36 F7         [10] 1295 	ld	(hl), #0xf7
   072C 21 0A 00      [10] 1296 	ld	hl, #0x000a
   072F 19            [11] 1297 	add	hl, de
   0730 36 15         [10] 1298 	ld	(hl), #0x15
   0732 21 0B 00      [10] 1299 	ld	hl, #0x000b
   0735 19            [11] 1300 	add	hl, de
   0736 36 88         [10] 1301 	ld	(hl), #0x88
   0738 21 0C 00      [10] 1302 	ld	hl, #0x000c
   073B 19            [11] 1303 	add	hl, de
   073C 36 09         [10] 1304 	ld	(hl), #0x09
   073E 21 0D 00      [10] 1305 	ld	hl, #0x000d
   0741 19            [11] 1306 	add	hl, de
   0742 36 CF         [10] 1307 	ld	(hl), #0xcf
   0744 21 0E 00      [10] 1308 	ld	hl, #0x000e
   0747 19            [11] 1309 	add	hl, de
   0748 36 4F         [10] 1310 	ld	(hl), #0x4f
   074A 21 0F 00      [10] 1311 	ld	hl, #0x000f
   074D 19            [11] 1312 	add	hl, de
   074E 36 3C         [10] 1313 	ld	(hl), #0x3c
                           1314 ;source_code/aes128.c:138: uint8_t plaintext[16] = {
   0750 21 10 00      [10] 1315 	ld	hl, #16
   0753 39            [11] 1316 	add	hl, sp
   0754 4D            [ 4] 1317 	ld	c, l
   0755 44            [ 4] 1318 	ld	b, h
   0756 3E 32         [ 7] 1319 	ld	a, #0x32
   0758 02            [ 7] 1320 	ld	(bc), a
   0759 69            [ 4] 1321 	ld	l, c
   075A 60            [ 4] 1322 	ld	h, b
   075B 23            [ 6] 1323 	inc	hl
   075C 36 43         [10] 1324 	ld	(hl), #0x43
   075E 69            [ 4] 1325 	ld	l, c
   075F 60            [ 4] 1326 	ld	h, b
   0760 23            [ 6] 1327 	inc	hl
   0761 23            [ 6] 1328 	inc	hl
   0762 36 F6         [10] 1329 	ld	(hl), #0xf6
   0764 69            [ 4] 1330 	ld	l, c
   0765 60            [ 4] 1331 	ld	h, b
   0766 23            [ 6] 1332 	inc	hl
   0767 23            [ 6] 1333 	inc	hl
   0768 23            [ 6] 1334 	inc	hl
   0769 36 A8         [10] 1335 	ld	(hl), #0xa8
   076B 21 04 00      [10] 1336 	ld	hl, #0x0004
   076E 09            [11] 1337 	add	hl, bc
   076F 36 88         [10] 1338 	ld	(hl), #0x88
   0771 21 05 00      [10] 1339 	ld	hl, #0x0005
   0774 09            [11] 1340 	add	hl, bc
   0775 36 5A         [10] 1341 	ld	(hl), #0x5a
   0777 21 06 00      [10] 1342 	ld	hl, #0x0006
   077A 09            [11] 1343 	add	hl, bc
   077B 36 30         [10] 1344 	ld	(hl), #0x30
   077D 21 07 00      [10] 1345 	ld	hl, #0x0007
   0780 09            [11] 1346 	add	hl, bc
   0781 36 8D         [10] 1347 	ld	(hl), #0x8d
   0783 21 08 00      [10] 1348 	ld	hl, #0x0008
   0786 09            [11] 1349 	add	hl, bc
   0787 36 31         [10] 1350 	ld	(hl), #0x31
   0789 21 09 00      [10] 1351 	ld	hl, #0x0009
   078C 09            [11] 1352 	add	hl, bc
   078D 36 31         [10] 1353 	ld	(hl), #0x31
   078F 21 0A 00      [10] 1354 	ld	hl, #0x000a
   0792 09            [11] 1355 	add	hl, bc
   0793 36 98         [10] 1356 	ld	(hl), #0x98
   0795 21 0B 00      [10] 1357 	ld	hl, #0x000b
   0798 09            [11] 1358 	add	hl, bc
   0799 36 A2         [10] 1359 	ld	(hl), #0xa2
   079B 21 0C 00      [10] 1360 	ld	hl, #0x000c
   079E 09            [11] 1361 	add	hl, bc
   079F 36 E0         [10] 1362 	ld	(hl), #0xe0
   07A1 21 0D 00      [10] 1363 	ld	hl, #0x000d
   07A4 09            [11] 1364 	add	hl, bc
   07A5 36 37         [10] 1365 	ld	(hl), #0x37
   07A7 21 0E 00      [10] 1366 	ld	hl, #0x000e
   07AA 09            [11] 1367 	add	hl, bc
   07AB 36 07         [10] 1368 	ld	(hl), #0x07
   07AD 21 0F 00      [10] 1369 	ld	hl, #0x000f
   07B0 09            [11] 1370 	add	hl, bc
   07B1 36 34         [10] 1371 	ld	(hl), #0x34
                           1372 ;source_code/aes128.c:145: aes128_encrypt(plaintext, ciphertext, key);
   07B3 21 20 00      [10] 1373 	ld	hl, #32
   07B6 39            [11] 1374 	add	hl, sp
   07B7 DD 75 FC      [19] 1375 	ld	-4 (ix), l
   07BA DD 74 FD      [19] 1376 	ld	-3 (ix), h
   07BD DD 7E FC      [19] 1377 	ld	a, -4 (ix)
   07C0 DD 77 FE      [19] 1378 	ld	-2 (ix), a
   07C3 DD 7E FD      [19] 1379 	ld	a, -3 (ix)
   07C6 DD 77 FF      [19] 1380 	ld	-1 (ix), a
   07C9 69            [ 4] 1381 	ld	l, c
   07CA 60            [ 4] 1382 	ld	h, b
   07CB C5            [11] 1383 	push	bc
   07CC D5            [11] 1384 	push	de
   07CD DD 5E FE      [19] 1385 	ld	e, -2 (ix)
   07D0 DD 56 FF      [19] 1386 	ld	d, -1 (ix)
   07D3 D5            [11] 1387 	push	de
   07D4 E5            [11] 1388 	push	hl
   07D5 CDrD7r05      [17] 1389 	call	_aes128_encrypt
   07D8 F1            [10] 1390 	pop	af
   07D9 F1            [10] 1391 	pop	af
   07DA 21r55r08      [10] 1392 	ld	hl, #___str_1
   07DD E3            [19] 1393 	ex	(sp),hl
   07DE CDr00r00      [17] 1394 	call	_puts
   07E1 21r68r08      [10] 1395 	ld	hl, #___str_2
   07E4 E3            [19] 1396 	ex	(sp),hl
   07E5 CDr00r00      [17] 1397 	call	_printf
   07E8 F1            [10] 1398 	pop	af
   07E9 C1            [10] 1399 	pop	bc
                           1400 ;source_code/aes128.c:149: for (int i = 0; i < 16; i++) printf("%02x ", plaintext[i]);
   07EA 11 00 00      [10] 1401 	ld	de, #0x0000
   07ED                    1402 00104$:
   07ED 7B            [ 4] 1403 	ld	a, e
   07EE D6 10         [ 7] 1404 	sub	a, #0x10
   07F0 7A            [ 4] 1405 	ld	a, d
   07F1 17            [ 4] 1406 	rla
   07F2 3F            [ 4] 1407 	ccf
   07F3 1F            [ 4] 1408 	rra
   07F4 DE 80         [ 7] 1409 	sbc	a, #0x80
   07F6 30 17         [12] 1410 	jr	NC,00101$
   07F8 69            [ 4] 1411 	ld	l, c
   07F9 60            [ 4] 1412 	ld	h, b
   07FA 19            [11] 1413 	add	hl, de
   07FB 6E            [ 7] 1414 	ld	l, (hl)
   07FC 26 00         [ 7] 1415 	ld	h, #0x00
   07FE C5            [11] 1416 	push	bc
   07FF D5            [11] 1417 	push	de
   0800 E5            [11] 1418 	push	hl
   0801 21r75r08      [10] 1419 	ld	hl, #___str_3
   0804 E5            [11] 1420 	push	hl
   0805 CDr00r00      [17] 1421 	call	_printf
   0808 F1            [10] 1422 	pop	af
   0809 F1            [10] 1423 	pop	af
   080A D1            [10] 1424 	pop	de
   080B C1            [10] 1425 	pop	bc
   080C 13            [ 6] 1426 	inc	de
   080D 18 DE         [12] 1427 	jr	00104$
   080F                    1428 00101$:
                           1429 ;source_code/aes128.c:150: printf("\n");
   080F 21r7Br08      [10] 1430 	ld	hl, #___str_5
   0812 E5            [11] 1431 	push	hl
   0813 CDr00r00      [17] 1432 	call	_puts
                           1433 ;source_code/aes128.c:152: printf("Ciphertext: ");
   0816 21r7Cr08      [10] 1434 	ld	hl, #___str_6
   0819 E3            [19] 1435 	ex	(sp),hl
   081A CDr00r00      [17] 1436 	call	_printf
   081D F1            [10] 1437 	pop	af
                           1438 ;source_code/aes128.c:153: for (int i = 0; i < 16; i++) printf("%02x ", ciphertext[i]);
   081E 01 00 00      [10] 1439 	ld	bc, #0x0000
   0821                    1440 00107$:
   0821 79            [ 4] 1441 	ld	a, c
   0822 D6 10         [ 7] 1442 	sub	a, #0x10
   0824 78            [ 4] 1443 	ld	a, b
   0825 17            [ 4] 1444 	rla
   0826 3F            [ 4] 1445 	ccf
   0827 1F            [ 4] 1446 	rra
   0828 DE 80         [ 7] 1447 	sbc	a, #0x80
   082A 30 19         [12] 1448 	jr	NC,00102$
   082C DD 6E FC      [19] 1449 	ld	l, -4 (ix)
   082F DD 66 FD      [19] 1450 	ld	h, -3 (ix)
   0832 09            [11] 1451 	add	hl, bc
   0833 5E            [ 7] 1452 	ld	e, (hl)
   0834 16 00         [ 7] 1453 	ld	d, #0x00
   0836 C5            [11] 1454 	push	bc
   0837 D5            [11] 1455 	push	de
   0838 21r75r08      [10] 1456 	ld	hl, #___str_3
   083B E5            [11] 1457 	push	hl
   083C CDr00r00      [17] 1458 	call	_printf
   083F F1            [10] 1459 	pop	af
   0840 F1            [10] 1460 	pop	af
   0841 C1            [10] 1461 	pop	bc
   0842 03            [ 6] 1462 	inc	bc
   0843 18 DC         [12] 1463 	jr	00107$
   0845                    1464 00102$:
                           1465 ;source_code/aes128.c:154: printf("\n");
   0845 21r7Br08      [10] 1466 	ld	hl, #___str_5
   0848 E5            [11] 1467 	push	hl
   0849 CDr00r00      [17] 1468 	call	_puts
   084C F1            [10] 1469 	pop	af
                           1470 ;source_code/aes128.c:156: return 0;
   084D 21 00 00      [10] 1471 	ld	hl, #0x0000
                           1472 ;source_code/aes128.c:157: }
   0850 DD F9         [10] 1473 	ld	sp, ix
   0852 DD E1         [14] 1474 	pop	ix
   0854 C9            [10] 1475 	ret
   0855                    1476 ___str_1:
   0855 41 45 53 2D 31 32  1477 	.ascii "AES-128 Encryption"
        38 20 45 6E 63 72
        79 70 74 69 6F 6E
   0867 00                 1478 	.db 0x00
   0868                    1479 ___str_2:
   0868 50 6C 61 69 6E 74  1480 	.ascii "Plaintext:  "
        65 78 74 3A 20 20
   0874 00                 1481 	.db 0x00
   0875                    1482 ___str_3:
   0875 25 30 32 78 20     1483 	.ascii "%02x "
   087A 00                 1484 	.db 0x00
   087B                    1485 ___str_5:
   087B 00                 1486 	.db 0x00
   087C                    1487 ___str_6:
   087C 43 69 70 68 65 72  1488 	.ascii "Ciphertext: "
        74 65 78 74 3A 20
   0888 00                 1489 	.db 0x00
                           1490 	.area _CODE
                           1491 	.area _INITIALIZER
                           1492 	.area _CABS (ABS)
